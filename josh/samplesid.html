<html>
	<head>
		<link rel="stylesheet" type="text/css" href="http://getbootstrap.com/docs/4.1/dist/css/bootstrap.min.css">
		    <link href="https://akshatmittal.com/youtube-realtime/assets/plugins/odometer/odometer-theme.css" rel="stylesheet">

		<style type="text/css">
			body {
				padding-top: 2rem;
				padding-bottom: 2rem;
				}
				h1 {
					font-size: 5rem;
				}
				h3 {
				margin-top: 2rem;
				}
				.row {
				margin-bottom: 1rem;
				}
				.row .row {
				margin-top: 1rem;
				margin-bottom: 0;
				}
				[class*="col-"] {
				padding-top: 1rem;
				padding-bottom: 1rem;
				}
				hr {
				margin-top: 2rem;
				margin-bottom: 2rem;
				}
				iframe {
					pointer-events: none;
				}
		</style>
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>

	</head>
	<body>
		<div class="container">
			<h3><center>Josh</center></h3>
			<div class="row">
				<div class="col-6" style="text-align: center; ">Subs:<h1 id="total"></h1></div>
				<div class="col-6" style="text-align: center; ">Views:<h1 id="totalV"></h1></div>
				<div class="col-9" style="text-align: center; "><iframe frameborder="0" src="https://akshatmittal.com/youtube-realtime/embed/#!/UCGYlNGlloLLZiAL3zBgbMgQ" style="border: 0; width:max; height:max; background-color: #FFF;" id="english"></iframe></div>
				<div class="col-9" style="text-align: center; "><iframe frameborder="0" src="https://akshatmittal.com/youtube-realtime/embed/#!/UC5MaEdGrolKRJXFdXgD7RAA" style="border: 0; width:max; height:max; background-color: #FFF;"></iframe></div>
				<div class="col-9" style="text-align: center; "><iframe frameborder="0" src="https://akshatmittal.com/youtube-realtime/embed/#!/UC6KXCdfpkCGmRTgBPj9hdbQ" style="border: 0; width:max; height:max; background-color: #FFF;"></iframe></div>
				<div class="col-9" style="text-align: center; "><iframe frameborder="0" src="https://akshatmittal.com/youtube-realtime/embed/#!/UC2KhNQ3pAmkN6Kepf8ccFZQ" style="border: 0; width:max; height:max; background-color: #FFF;"></iframe></div>
				<div class="col-9" style="text-align: center; "><iframe frameborder="0" src="https://akshatmittal.com/youtube-realtime/embed/#!/UCE6Y7GPi7LG3_w0cmBFZRwA" style="border: 0; width:max; height:max; background-color: #FFF;"></iframe></div>
				<div class="col-9" style="text-align: center; "><iframe frameborder="0" src="https://akshatmittal.com/youtube-realtime/embed/#!/UCTOWKyc49SY32OYtXontXoQ" style="border: 0; width:max; height:max; background-color: #FFF;"></iframe></div>
				<div class="col-9" style="text-align: center; "><iframe frameborder="0" src="https://akshatmittal.com/youtube-realtime/embed/#!/UCHO1It3X8dB0Lfxer_4ev-A" style="border: 0; width:max; height:max; background-color: #FFF;"></iframe></div>
				<div class="col-9" style="text-align: center; "><iframe frameborder="0" src="https://akshatmittal.com/youtube-realtime/embed/#!/UCUbhtpmudp_9vfmytdcD3lQ" style="border: 0; width:max; height:max; background-color: #FFF;"></iframe></div>
				<div class="col-9" style="text-align: center; "><iframe frameborder="0" src="https://akshatmittal.com/youtube-realtime/embed/#!/UChlEKXoTTTizQN5trVkyNiQ" style="border: 0; width:max; height:max; background-color: #FFF;"></iframe></div>

			</div>
		</div>
		<script src="https://akshatmittal.com/youtube-realtime/assets/plugins/odometer/odometer.min.js" ></script>
		<script type="text/javascript">
			$(document).ready(function() {
    		var el = document.querySelector('#total');

    	od = new Odometer({
        el: el,
        value: 0,
        format: '(,ddd).dd',
        theme: 'minimal'
    	});
			od2 = new Odometer({
		    el: document.querySelector('#totalV'),
		    value: 0,
		    format: '(,ddd).dd',
		    theme: 'minimal'
		  });
    	// "AIzaSyAH88MZSlEKfL-fzYp8_Hu0nCbYVp3ikTs"
    	var YT = {};
    	YT.keyManager = {
        keys: ["AIzaSyCirzn_euhI10MY2_Mo1gQjgult6_Rw4CY", "AIzaSyBh9NX-IZVLyk6C2nt448dYYuwmIMdPvpI", "AIzaSyBR1Fz9C-5PM1-56g6l3fc3jTNxeVioIrI", "AIzaSyDgNPwHuae7dtgwmZwhpdKDC8xYahugz-w", "AIzaSyCuXXjTVn79AENIQiJfRSYDLzeZIzZyqg4"],
        keyIndex: 0,
        getKey: function() {
            this.keyIndex = (this.keyIndex + 1) % (this.keys.length);
            return this.keys[this.keyIndex];
        },
        shuffleKeys: function() {
            this.keys.shuffle();
        },
				invalidateKey: function(k){
	    		this.keys = array.filter(function(value, index, arr){
	        	return value !== k;
	    		});
				}
    	}
    	YT.updateManager = {
        updateSubs: function(e) {
            od.update(e);
        }
    	};
    	YT.live = {
    	countMap: {},
			countMapV: {},
        channelIDs: ["UCGYlNGlloLLZiAL3zBgbMgQ", "UC5MaEdGrolKRJXFdXgD7RAA", "UC6KXCdfpkCGmRTgBPj9hdbQ", "UC2KhNQ3pAmkN6Kepf8ccFZQ", "UCE6Y7GPi7LG3_w0cmBFZRwA", "UCTOWKyc49SY32OYtXontXoQ", "UCHO1It3X8dB0Lfxer_4ev-A", "UCUbhtpmudp_9vfmytdcD3lQ", "UChlEKXoTTTizQN5trVkyNiQ"],
        update: function() {
            var total_count = 0;
						var total_countV = 0;
            var promises = [];
            countMap = this.countMap;
						countMapV = this.countMapV;
            $.each(this.channelIDs, function(x, y) {
                promises.push($.getJSON("https://www.googleapis.com/youtube/v3/channels?part=statistics&id=" + y + "&key=" + YT.keyManager.getKey()));
            });
            $.when(promises).done(function(a){
            	count = 0;
            	$.each(a, function(c, b){
            		b.then(function(x){
            			countMap[x.items[0].id] =parseInt(x.items[0].statistics.subscriberCount);
									countMapV[x.items[0].id] =parseInt(x.items[0].statistics.viewCount);
            		})
            	})
            });
            this.countMap = countMap;
						this.countMapV = countMapV;
            console.log(countMap);
            $.each(countMap, function(a, b){total_count+=b});
						console.log(countMapV);
            $.each(countMapV, function(a, b){total_countV+=b});
            YT.updateManager.updateSubs(total_count);
						od2.update(total_countV);


        },
        timer: null,
        start: function() {
            this.timer = setInterval(function(e) {
                YT.live.update();
            }, 1000);
        },
        stop: function() {
            clearInterval(this.timer);
        }
    };

    	$(function() {
        YT.live.start();
    	});
    	$(document).ready(function(){
    		$(window).focus(function(){
	    		console.log('started ');
          YT.live.start();
    		});
    		$(window).blur(function(){
          console.log('paused');
          YT.live.stop();
      	});
    	});
});
	</script>
	</body>

</html>
